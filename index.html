<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Column Index Calculator</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0f;
    --surface: #13131a;
    --surface2: #1c1c28;
    --border: #2a2a3d;
    --accent1: #00e5ff;
    --accent2: #ff3d80;
    --accent3: #aaff00;
    --text: #e8e8f0;
    --muted: #6b6b8a;
    --glow1: rgba(0,229,255,0.15);
    --glow2: rgba(255,61,128,0.15);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Space Mono', monospace;
    min-height: 100vh;
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* Animated grid background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(0,229,255,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,229,255,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  .container {
    position: relative;
    z-index: 1;
    width: 100%;
    max-width: 760px;
    padding: 40px 24px 80px;
  }

  /* Header */
  .header {
    text-align: center;
    margin-bottom: 48px;
    animation: fadeDown 0.7s ease both;
  }

  .header .tag {
    display: inline-block;
    font-size: 11px;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--accent1);
    border: 1px solid var(--accent1);
    padding: 4px 14px;
    border-radius: 2px;
    margin-bottom: 16px;
    opacity: 0.8;
  }

  .header h1 {
    font-family: 'Syne', sans-serif;
    font-size: clamp(28px, 6vw, 52px);
    font-weight: 800;
    line-height: 1.05;
    letter-spacing: -0.02em;
  }

  .header h1 span.c1 { color: var(--accent1); }
  .header h1 span.c2 { color: var(--accent2); }
  .header h1 span.c3 { color: var(--accent3); }

  .header p {
    margin-top: 12px;
    color: var(--muted);
    font-size: 13px;
    letter-spacing: 0.05em;
  }

  /* Cards */
  .cards {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
  }

  @media (max-width: 560px) {
    .cards { grid-template-columns: 1fr; }
  }

  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 28px 24px;
    position: relative;
    overflow: hidden;
    transition: border-color 0.3s, transform 0.3s;
    animation: fadeUp 0.7s ease both;
  }

  .card:nth-child(1) { animation-delay: 0.1s; }
  .card:nth-child(2) { animation-delay: 0.2s; }

  .card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--card-accent, var(--accent1)), transparent);
    opacity: 0;
    transition: opacity 0.3s;
  }

  .card:hover::before { opacity: 1; }
  .card:hover { border-color: var(--card-accent, var(--accent1)); transform: translateY(-2px); }

  .card.card-a { --card-accent: var(--accent1); }
  .card.card-b { --card-accent: var(--accent2); }

  /* Corner glow */
  .card::after {
    content: '';
    position: absolute;
    bottom: -40px; right: -40px;
    width: 120px; height: 120px;
    border-radius: 50%;
    background: var(--card-glow, var(--glow1));
    filter: blur(30px);
    pointer-events: none;
  }
  .card.card-a { --card-glow: var(--glow1); }
  .card.card-b { --card-glow: var(--glow2); }

  .card-label {
    font-size: 10px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .card-label .dot {
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--card-accent, var(--accent1));
    display: inline-block;
    box-shadow: 0 0 8px var(--card-accent, var(--accent1));
  }

  .input-group {
    display: flex;
    align-items: center;
    gap: 0;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    transition: border-color 0.2s, box-shadow 0.2s;
    overflow: hidden;
  }

  .input-group:focus-within {
    border-color: var(--card-accent, var(--accent1));
    box-shadow: 0 0 0 3px rgba(0,229,255,0.08);
  }

  .card.card-b .input-group:focus-within {
    box-shadow: 0 0 0 3px rgba(255,61,128,0.08);
  }

  .input-group input {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: var(--text);
    font-family: 'Space Mono', monospace;
    font-size: 24px;
    font-weight: 700;
    padding: 14px 16px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    width: 0; /* fix flex overflow */
  }

  .input-group input::placeholder { color: var(--border); }

  .input-group input[type="number"] {
    text-transform: none;
    -moz-appearance: textfield;
  }
  .input-group input[type="number"]::-webkit-outer-spin-button,
  .input-group input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; }

  .clear-btn {
    background: none;
    border: none;
    color: var(--muted);
    cursor: pointer;
    padding: 14px 14px;
    font-size: 16px;
    transition: color 0.2s;
    line-height: 1;
  }
  .clear-btn:hover { color: var(--accent2); }

  .arrow {
    text-align: center;
    font-size: 18px;
    color: var(--muted);
    margin: 14px 0;
  }

  .result-box {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 14px 16px;
    min-height: 60px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    transition: border-color 0.3s;
  }

  .result-box.has-result {
    border-color: var(--card-accent, var(--accent1));
  }

  .result-value {
    font-family: 'Syne', sans-serif;
    font-size: 28px;
    font-weight: 800;
    color: var(--card-accent, var(--accent1));
    letter-spacing: 0.05em;
    transition: all 0.2s;
    word-break: break-all;
  }

  .result-value.empty { color: var(--border); font-size: 18px; font-family: 'Space Mono'; font-weight: 400; }

  .copy-btn {
    flex-shrink: 0;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 6px;
    color: var(--muted);
    cursor: pointer;
    padding: 6px 10px;
    font-size: 11px;
    font-family: 'Space Mono', monospace;
    letter-spacing: 0.05em;
    transition: all 0.2s;
    white-space: nowrap;
  }

  .copy-btn:hover { color: var(--card-accent, var(--accent1)); border-color: var(--card-accent, var(--accent1)); }
  .copy-btn.copied { color: var(--accent3); border-color: var(--accent3); }

  .error-msg {
    margin-top: 8px;
    font-size: 11px;
    color: var(--accent2);
    min-height: 16px;
    letter-spacing: 0.05em;
  }

  /* Reference Table */
  .ref-section {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    animation: fadeUp 0.7s ease 0.4s both;
  }

  .ref-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
    flex-wrap: wrap;
    gap: 12px;
  }

  .ref-header h3 {
    font-family: 'Syne', sans-serif;
    font-size: 16px;
    font-weight: 700;
    color: var(--accent3);
  }

  .search-box {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 6px 12px;
    color: var(--text);
    font-family: 'Space Mono', monospace;
    font-size: 12px;
    outline: none;
    width: 160px;
    transition: border-color 0.2s;
  }
  .search-box:focus { border-color: var(--accent3); }
  .search-box::placeholder { color: var(--muted); }

  .table-wrap {
    max-height: 260px;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }

  .table-wrap::-webkit-scrollbar { width: 4px; }
  .table-wrap::-webkit-scrollbar-track { background: transparent; }
  .table-wrap::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
  }

  thead th {
    position: sticky; top: 0;
    background: var(--surface);
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.15em;
    font-size: 10px;
    padding: 8px 12px;
    text-align: left;
    border-bottom: 1px solid var(--border);
  }

  tbody tr {
    border-bottom: 1px solid rgba(255,255,255,0.03);
    transition: background 0.15s;
    cursor: pointer;
  }

  tbody tr:hover { background: var(--surface2); }
  tbody tr.highlight { background: rgba(170,255,0,0.07); }
  tbody tr.highlight td:first-child { color: var(--accent3); }
  tbody tr.highlight td:last-child { color: var(--accent3); }

  tbody td {
    padding: 7px 12px;
    color: var(--text);
    letter-spacing: 0.05em;
  }

  tbody td:first-child { color: var(--accent1); font-weight: 700; }
  tbody td:last-child { color: var(--muted); }

  .no-results {
    text-align: center;
    color: var(--muted);
    padding: 24px;
    font-size: 12px;
    letter-spacing: 0.1em;
  }

  /* Stats bar */
  .stats {
    display: flex;
    gap: 20px;
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid var(--border);
    flex-wrap: wrap;
  }

  .stat {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .stat-label { font-size: 9px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.2em; }
  .stat-value { font-size: 14px; font-weight: 700; color: var(--text); }
  .stat-value span { color: var(--accent3); }

  /* Animations */
  @keyframes fadeDown {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .result-value.pop {
    animation: pop 0.25s ease;
  }
  @keyframes pop {
    0% { transform: scale(1); }
    50% { transform: scale(1.08); }
    100% { transform: scale(1); }
  }
</style>
</head>
<body>
<div class="container">

  <div class="header">
    <div class="tag">Spreadsheet Tool</div>
    <h1><span class="c1">Column</span> <span class="c2">Index</span><br><span class="c3">Calculator</span></h1>
    <p>Convert between column labels and index numbers — instantly</p>
  </div>

  <div class="cards">
    <!-- Card A: Label → Index -->
    <div class="card card-a">
      <div class="card-label"><span class="dot"></span> Label → Index</div>
      <div class="input-group">
        <input type="text" id="labelInput" placeholder="CH" maxlength="4" autocomplete="off" spellcheck="false" />
        <button class="clear-btn" onclick="clearCard('a')" title="Clear">✕</button>
      </div>
      <div class="arrow">↓</div>
      <div class="result-box" id="resultBoxA">
        <span class="result-value empty" id="resultA">—</span>
        <button class="copy-btn" id="copyA" onclick="copyResult('a')" style="display:none">copy</button>
      </div>
      <div class="error-msg" id="errorA"></div>
    </div>

    <!-- Card B: Index → Label -->
    <div class="card card-b">
      <div class="card-label"><span class="dot"></span> Index → Label</div>
      <div class="input-group">
        <input type="number" id="indexInput" placeholder="86" min="1" max="16384" autocomplete="off" />
        <button class="clear-btn" onclick="clearCard('b')" title="Clear">✕</button>
      </div>
      <div class="arrow">↓</div>
      <div class="result-box" id="resultBoxB">
        <span class="result-value empty" id="resultB">—</span>
        <button class="copy-btn" id="copyB" onclick="copyResult('b')" style="display:none">copy</button>
      </div>
      <div class="error-msg" id="errorB"></div>
    </div>
  </div>

  <!-- Reference Table -->
  <div class="ref-section">
    <div class="ref-header">
      <h3>Reference Table</h3>
      <input type="text" class="search-box" id="refSearch" placeholder="Search label or #..." oninput="filterTable()" />
    </div>
    <div class="table-wrap">
      <table>
        <thead>
          <tr><th>Column Label</th><th>Index Number</th></tr>
        </thead>
        <tbody id="refBody"></tbody>
      </table>
      <div class="no-results" id="noResults" style="display:none">No results found</div>
    </div>
    <div class="stats">
      <div class="stat">
        <span class="stat-label">Total Columns</span>
        <span class="stat-value"><span>16,384</span></span>
      </div>
      <div class="stat">
        <span class="stat-label">Max Label</span>
        <span class="stat-value"><span>XFD</span></span>
      </div>
      <div class="stat">
        <span class="stat-label">Shown in Table</span>
        <span class="stat-value"><span id="shownCount">702</span> (A–ZZ)</span>
      </div>
    </div>
  </div>

</div>

<script>
  // ── Core conversion functions ──────────────────────────────────────────────
  function labelToIndex(label) {
    label = label.trim().toUpperCase();
    if (!/^[A-Z]{1,4}$/.test(label)) return null;
    let result = 0;
    for (let i = 0; i < label.length; i++) {
      result = result * 26 + (label.charCodeAt(i) - 64);
    }
    if (result > 16384) return null; // Excel max
    return result;
  }

  function indexToLabel(n) {
    n = parseInt(n);
    if (isNaN(n) || n < 1 || n > 16384) return null;
    let label = '';
    while (n > 0) {
      n--;
      label = String.fromCharCode(65 + (n % 26)) + label;
      n = Math.floor(n / 26);
    }
    return label;
  }

  // ── Input handlers ────────────────────────────────────────────────────────
  const labelInput = document.getElementById('labelInput');
  const indexInput = document.getElementById('indexInput');

  labelInput.addEventListener('input', () => {
    const val = labelInput.value.trim();
    const errEl = document.getElementById('errorA');
    const resEl = document.getElementById('resultA');
    const boxEl = document.getElementById('resultBoxA');
    const copyEl = document.getElementById('copyA');

    if (!val) {
      reset('a'); return;
    }

    if (!/^[A-Za-z]{1,4}$/.test(val)) {
      errEl.textContent = 'Only A–Z letters allowed';
      setResult('a', null, false); return;
    }

    const idx = labelToIndex(val);
    errEl.textContent = '';
    if (idx === null) {
      setResult('a', null, false);
      errEl.textContent = 'Exceeds max column (XFD = 16384)';
    } else {
      setResult('a', idx, true);
      highlightRow(val.toUpperCase());
    }
  });

  indexInput.addEventListener('input', () => {
    const val = indexInput.value.trim();
    const errEl = document.getElementById('errorB');

    if (!val) { reset('b'); return; }

    const label = indexToLabel(val);
    errEl.textContent = '';
    if (label === null) {
      setResult('b', null, false);
      errEl.textContent = 'Enter a number between 1 and 16384';
    } else {
      setResult('b', label, true);
      highlightRow(label);
    }
  });

  function setResult(card, value, valid) {
    const resEl = document.getElementById(`result${card.toUpperCase()}`);
    const boxEl = document.getElementById(`resultBox${card.toUpperCase()}`);
    const copyEl = document.getElementById(`copy${card.toUpperCase()}`);

    if (valid && value !== null) {
      resEl.textContent = value;
      resEl.className = 'result-value pop';
      boxEl.classList.add('has-result');
      copyEl.style.display = 'inline-block';
      setTimeout(() => resEl.classList.remove('pop'), 300);
    } else {
      resEl.textContent = value === null && !valid ? '???' : '—';
      resEl.className = `result-value${valid ? '' : ' empty'}`;
      boxEl.classList.remove('has-result');
      copyEl.style.display = 'none';
    }
  }

  function reset(card) {
    setResult(card, null, false);
    document.getElementById(`result${card.toUpperCase()}`).textContent = '—';
    document.getElementById(`error${card.toUpperCase()}`).textContent = '';
    clearHighlight();
  }

  function clearCard(card) {
    if (card === 'a') labelInput.value = '';
    else indexInput.value = '';
    reset(card);
  }

  // ── Copy ──────────────────────────────────────────────────────────────────
  function copyResult(card) {
    const val = document.getElementById(`result${card.toUpperCase()}`).textContent;
    if (!val || val === '—' || val === '???') return;
    navigator.clipboard.writeText(val).then(() => {
      const btn = document.getElementById(`copy${card.toUpperCase()}`);
      btn.textContent = 'copied!';
      btn.classList.add('copied');
      setTimeout(() => { btn.textContent = 'copy'; btn.classList.remove('copied'); }, 1500);
    });
  }

  // ── Reference Table ───────────────────────────────────────────────────────
  const allRows = [];

  function buildTable() {
    const body = document.getElementById('refBody');
    const labels = [];
    for (let c = 65; c <= 90; c++) labels.push(String.fromCharCode(c));
    for (let c1 = 65; c1 <= 90; c1++)
      for (let c2 = 65; c2 <= 90; c2++)
        labels.push(String.fromCharCode(c1) + String.fromCharCode(c2));

    const frag = document.createDocumentFragment();
    labels.forEach((lbl, i) => {
      const tr = document.createElement('tr');
      tr.dataset.label = lbl;
      tr.dataset.index = i + 1;
      tr.innerHTML = `<td>${lbl}</td><td>${i + 1}</td>`;
      tr.addEventListener('click', () => {
        labelInput.value = lbl;
        labelInput.dispatchEvent(new Event('input'));
        labelInput.focus();
      });
      frag.appendChild(tr);
      allRows.push(tr);
    });
    body.appendChild(frag);
  }

  function filterTable() {
    const q = document.getElementById('refSearch').value.trim().toLowerCase();
    let shown = 0;
    allRows.forEach(tr => {
      const match = !q ||
        tr.dataset.label.toLowerCase().includes(q) ||
        tr.dataset.index.includes(q);
      tr.style.display = match ? '' : 'none';
      if (match) shown++;
    });
    document.getElementById('noResults').style.display = shown === 0 ? 'block' : 'none';
    document.getElementById('shownCount').textContent = shown;
  }

  let currentHighlight = null;
  function highlightRow(label) {
    if (currentHighlight) currentHighlight.classList.remove('highlight');
    const tr = allRows.find(r => r.dataset.label === label);
    if (tr) {
      tr.classList.add('highlight');
      currentHighlight = tr;
      // Only scroll if within A-ZZ table
      tr.scrollIntoView({ block: 'nearest', behavior: 'smooth' });
      // Also clear search to make it visible
      document.getElementById('refSearch').value = '';
      filterTable();
    }
  }

  function clearHighlight() {
    if (currentHighlight) { currentHighlight.classList.remove('highlight'); currentHighlight = null; }
  }

  buildTable();
</script>
</body>
</html>
